%% bare_jrnl.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}

%%%% packages and definitions (optional)
\usepackage{graphicx} % allows inclusion of graphics
\usepackage{booktabs} % nice rules (thick lines) for tables
\usepackage{microtype} % improves typography for PDF
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{tabulary}
\usepackage{amssymb}
\usepackage{hyperref}

% \usepackage{caption}
%\usepackage{subcaption}
\usepackage{bm}
\usepackage{float}
\usepackage{tikz}
\usepackage{verbatim}
\usetikzlibrary{arrows,shapes}
 
\usepackage{braket}
\usepackage[figuresright]{rotating}

%% ----Putting 2 pic into 1
% \documentclass{articles}
\usepackage{graphicx}
\newcommand{\SN}{S$_N$}
\renewcommand{\vec}[1]{\bm{#1}} %vector is bold italic
\newcommand{\vd}{\bm{\cdot}} % slightly bold vector dot
\newcommand{\grad}{\vec{\nabla}} % gradient
\newcommand{\ud}{\mathop{}\!\mathrm{d}} % upright derivative symbol
\providecommand{\e}[1]{\ensuremath{\vd 10^{#1}}}
\newcommand{\oper}[1]{\mathcal{#1}}
\newcommand{\EQ}[1]{Eq.~(\ref{#1})}               %-- Eq. (refeq)
\newcommand{\EQUATION}[1]{Equation~(\ref{#1})}    %-- Equation (refeq)
\newcommand{\FIG}[1]{Fig.~\ref{#1}}               %-- Fig. refig
\newcommand{\FIGURE}[1]{Figure~\ref{#1}}          %-- Figure refig
\newcommand{\TAB}[1]{Table~\ref{#1}}              %-- Table tablref
\newcommand{\EQS}[2]{Eqs.~(\ref{#1})--(\ref{#2})}            %-- Eqs. (refeqs)
\newcommand{\EQUATIONS}[2]{Equations~(\ref{#1})--(\ref{#2})} %-- Eqs. (refeqs)
\newcommand{\EQSTWO}[2]{Eqs.~(\ref{#1})~and~(\ref{#2})} %-- Eqs. (refeqs)
\newcommand{\EQUATIONSTWO}[2]{Equations~(\ref{#1})~and~(\ref{#2})}             
%-- Eqs. (refeqs
\newcommand{\BOXEQ}[1]{\mbox{\fboxsep=.13in $$
    \framebox{#1} $$ } }    %-- box around equation
\newcommand{\SEC}[1]{Section~\ref{#1}}               %-- Eq. (refeq)
\newcommand{\REF}[1]{Ref.~\citen{#1}}               %-- Eq. (refeq)
\DeclareMathOperator*{\dotp}{{\scriptscriptstyle \stackrel{\bullet}{{}}}}



% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)


% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{On Use of Multi-Chambered Fission Detectors \\for In-Core, Neutron Spectroscopy}

\author{Jeremy A. Roberts% <-this % stops a space
\thanks{This work was presented at the International Conference on Advancements in Nuclear Instrumentation Measurement Methods and their Applications, June 19-23, 2017.}
\thanks{J. Roberts is with the Department
of Mechanical and Nuclear Engineering, Kansas State University, Manhattan,
KS, 66502 (email: jaroberts@ksu.edu).}
% <-this % stops a space
}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
% \markboth{Journal of \LaTeX\ Class Files,~Vol.~14, No.~8, August~2015}%
% {Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
Presented is a short, computational study on the potential use of multichambered fission detectors for in-core, neutron spectroscopy.  Motivated by the development of very small fission chambers at CEA in France and at Kansas State University in the U.S., it was assumed in this preliminary analysis that devices can be made small enough to avoid flux perturbations and that uncertainties related to measurements can be ignored.  It was hypothesized that a sufficient number of chambers with unique reactants can act as a real-time, foil-activation experiment.  An unfolding scheme based on maximizing (Shannon) entropy was used to produce a flux spectrum from detector signals that requires no prior information. To test the method, integral, detector responses were generated for single-isotope detectors of various Th, U, Np, Pu, Am, and Cs isotopes using a simplified, pressurized-water reactor spectrum and flux-weighted, microscopic, fission cross sections, in the WIMS-69 multigroup format.  An unfolded spectrum was found from subsets of these responses that had a maximum entropy while reproducing the responses considered and summing to one (that is, they were normalized).   Several nuclide subsets were studied, and, as expected, the results indicate inclusion of more nuclides leads to better spectra but with diminishing improvements, with the best-case spectrum having an average, relative, group-wise error of approximately 51\%.  Furthermore, spectra found from minimum-norm and Tihkonov-regularization inversion were of lower quality than the maximum entropy solutions.  Finally, the addition of thermal-neutron filters (here, Cd and Gd) provided substantial improvement over unshielded responses alone.  The results, as a whole, suggest that in-core, neutron spectroscopy is at least marginally feasible.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
neutron spectroscopy, fission chambers, maximum entropy
\end{IEEEkeywords}






% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle


\section{Introduction}

\IEEEPARstart{I}n recent years, substantial interest has grown in the development of in-core instrumentation that can provide data for validation of advanced computational models for reactor analysis.  Work at Commissariat \`{a} l'\'{e}nergie atomique et aux \'{e}nergies alternatives (CEA) \cite{blandin2003development} to produce ``sub-miniature'' fission chambers and  at Kansas State University (KSU) \cite{mcgregor2005micro, reichenberger2016micro} to produce ``micro-pocket'' fission chambers has led to extremely small devices that provide opportunities for multiple, in-core flux monitors that can provide a detailed map of the core power over varying operational conditions.  Some work has been done to determine continuous flux shapes from the point-wise measurements \cite{shultis2005determining}, and ongoing research aims to provide devices capable of exhibiting linear response across many decades of power levels, e.g., as observed in pulsed reactors like the Transient Reactor Test Facility (TREAT) at Idaho National Laboratory and various university reactors, including the Training, Research, Isotopes, General Atomic (TRIGA) Mark II research reactor at KSU.

With their small size, it may be possible to use several, co-located sub-miniature or micro-pocket fission detectors to measure a neutron spectrum at a point. Even in the earliest developments at KSU, it was proposed to deploy two-chamber devices loaded with uranium and thorium, respectively, in order to distinguish between thermal and fast fluxes \cite{mcgregor2005micro}.  However, the threshold energy for thorium fission is approximately 1 MeV, too large to provide sufficient detail in the epithermal region. Here, alternative reactants, in greater number, were explored to understand how the resulting signals from multiple chambers could be used to resolve the neutron spectrum.  In particular, it was hypothesized that  a sufficient number of chambers with unique reactants can act as a real-time, foil-activation experiment and that, with appropriate prior modeling and uncertainties, a Bayesian framework can be used to provide improved estimates for the energy spectrum.  In this preliminary effort, no such prior information was assumed, leaving the full Bayesian framework for future work.  Rather, the focus was placed squarely on understanding how much information can be extracted from an unknown spectrum via a set of integral responses. The key throughout was the presumed availability of devices small enough that several can be placed in a small region and that any perturbations to the local flux (magnitude or spectrum) are negligible.

\section{Methods}

Shown in \FIG{fig:reactants} are the microscopic fission cross sections for several nuclides of Th, U, Np, Pu, Am, and Cm.  
\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/fission_cross_sections.pdf}
  \caption{Microscopic fission cross sections for several nuclides.  All data was pulled directly from NNDC \cite{nndc}.}
  \label{fig:reactants}
\end{figure}
The values shown are evaluated at 300 K.  The same cross sections are shown in the 69-group WIMS \cite{stammler1984methods} format condensed using the simplified, pressurized-water reactor (PWR)  spectrum shown in Fig. \ref{fig:spectra}.  
\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/fission_responses.pdf}
  \caption{Condensed microscropic, fission cross sections  in the WIMS 69-group format.}
  \label{fig:response}
\end{figure}
\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/test_spectrum.pdf}
  \caption{Simplified, PWR-like spectrum used to weight cross sections as response functions; the multigroup equivalent is also shown.}
  \label{fig:spectra}
\end{figure}
Observe that the spectrum used has no fine structure and, hence, represents a very simple test case for unfolding.  On a related note, the geometry of any detector of interest will be sufficiently small (by assumption) that the infinite-dilution approximation is valid.  In other words, self-shielding effects due to the detectors themselves are negligible and need not be accounted for in determination of the multigroup constants and, hence, the detector response functions.

Suppose an $N$-chamber device were produced having a sufficient mass of each reactant shown in \FIG{fig:response} to produce a measurable, negligible-uncertainty signal in some application reactor.  Suppose further that the goal is to determine the flux spectrum of the application reactor using the 69-group WIMS energy structure.  The resulting system of equations is 
\begin{equation}
  r_i = \sum_{g=1}^{69} \Sigma_{fg,i}  \phi_g\, , 
    \qquad i = 1 \ldots N \, ,
\label{eq:response}
\end{equation}
or, in matrix form,
\begin{equation}
 \mathbf{r} = \bm{\Sigma}_f \bm{\phi} \, ,
\end{equation}
where $\phi_g$ is the group-integrated flux, and it has been assumed that there are no losses due to dead time or discriminators.   This is a major assumption with respect to the technology, but if the response of each device is linear, and if any losses are proportional to the signal similarly for all reactants, then the equations need only be modified by a single, multiplicative constant on the right.  For real-world cases, further work must be done to include such features of the system explicitly.

\EQUATION{eq:response} is an underdetermined system, meaning that specialized techniques or additional constraints are needed.  Such a problem belongs to the class of  spectrum unfolding problems, itself a class of inverse problems.  Many methods have been proposed to solve such problems, whether arising from Bonner-sphere spectroscopy or other applications.  One simple inversion technique is to compute the minimum-norm solution, i.e.,
\begin{equation}
  \bm{\phi} =  \bm{\Sigma}  [\bm{\Sigma} \bm{\Sigma}^T]^{-1}\mathbf{r} \, ,
\end{equation}
which yields a spectrum $\bm{\phi}$ having the smallest Euclidean norm $|\bm{\phi}|_2 = \sqrt{\bm{\phi}^T\bm{\phi}}$.  Although unique, the minimum-norm solution is not guaranteed to be strictly positive.  

A second, straightforward inversion technique is Tihkonov regularization \cite{mueller2012lni}, i.e.,
\begin{equation}
 \bm{\phi} = [\bm{\Sigma}^T \bm{\Sigma}+ \mathbf{T}^T \mathbf{T}]^{-1} \bm{\Sigma} \mathbf{r} \, ,
\end{equation}
where a common regularization matrix is $\mathbf{T} = a\mathbf{I}$ for a scalar $a$ and identity matrix $\mathbf{I}$.  Like the minimum-norm solution, the Tikhonov-regularization solution may also contain negative values.

For the work presented here, the primary method used is based on entropy maximization \cite{itoh1989neutron}, in which the (Shannon) entropy of the spectrum is defined as
\begin{equation}
 S = -\sum^{69}_{g=1} \phi_g \ln \phi_g \, .
\label{eq:entropy}
\end{equation}
The flux spectrum with the greatest entropy that satisfies both \EQ{eq:response} and
\begin{equation}
 \sum^{69}_{g=1} \phi_g = 1
\label{eq:normalize}
\end{equation}
is found by solving the nonlinear, constrained optimization problem resulting from (\ref{eq:response})--(\ref{eq:normalize}).  Equation~\ref{eq:normalize} implies that the integrated flux is known, which may not be the case in practice.  However, the results below indicate that the unfolding process is not severely sensitive to the assumed, integral flux, meaning that even a crude estimate can be used.  If the constraint is not employed, the results are much less favorable.


\section{Results}

To demonstrate the use of entropy maximization for extracting spectral information from a set of unique, fission-chamber responses,  a simple test problem was studied.  In particular, the PWR spectrum shown in \FIG{fig:spectra} was taken to be the application spectrum, with which reference response functions (here, just the microscopic, multigroup, fission cross sections) were defined.  Then, spectra were unfolded for four base cases: (1) using only ${}^{235}$U, ${}^{238}$U, and ${}^{232}$Th, (2) using the case-1 nuclides in addition to ${}^{237}$Np and ${}^{238}$Pu, (3) using the case-2 nuclides in addition to ${}^{239}$Pu, ${}^{240}$Pu, and ${}^{231}$Pu, and (4) using all nuclides shown in \FIG{fig:response}.  Furthermore, case 3 was explored with and without the use of thermal-neutron filters (${}^{113}$Cd and ${}^{155}$Gd), while  case 4 was analyzed using minimum-norm and Thikonov-regularization inversion in addition to maximum-entropy inversion.\footnote{Note, all results and figures were computed using Python (3.6.0) with NumPy (1.11.3), SciPy (0.18.1), and Matplotlib (2.0.0).  All code to generate the figures and this document are available at \url{https://github.com/robertsj/fission_chamber_spectrometer}.}


The spectra resulting from maximum-entropy unfolding are shown in \FIG{fig:reconstructed_flux} and \FIG{fig:reconstructed_flux_lethargy}, with the group-wise, relative error shown in \FIG{fig:error}. The four cases led to average, relative, group-wise errors of 201\%, 126\%, 63\%, and 51\%, respectively.   The rather simple algorithm (with no prior information), is able to produce reasonably close spectral shapes with as few as 5 responses.  It was observed in scoping studies that inclusion of ${}^{238}$Pu has an important effect on the unfolding process.  In particular, and as can be observed in \FIG{fig:error}, the error between groups 30 and 45 (or energies from 0.78 to 2.1 eV) is reduced substantially with inclusion of ${}^{238}$Pu and its transmutation precursor, ${}^{237}$Np.  However, errors remain in this energy range and lower energies, which indicates that additional, thermal-sensitive information (e.g., from thermal filters like Cd) may be of use.

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/reconstructed_flux.pdf}
  \caption{Unfolded, multigroup spectra for cases 1--3 with reference spectrum for comparison.}
  \label{fig:reconstructed_flux}
\end{figure}

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/reconstructed_flux_lethargy.pdf}
  \caption{Same as \FIG{fig:reconstructed_flux} but per unit lethargy.}
  \label{fig:reconstructed_flux_lethargy}
\end{figure}

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/groupwise_error.pdf}
  \caption{Group-wise, relative errors (\%).  Average error shown in parentheses inside the legend.}
  \label{fig:error}
\end{figure}


Recall that (\ref{eq:normalize}) implies that the total flux is known as part of the maximum entropy unfolding process.  However, the total flux may not be known, or it may be known only imprecisely.  To understand how the total flux constraint impacts the unfolded spectrum, case 4 was solved using three different total fluxes: 1.0, 0.5, and 2.0.  For all three cases, a flux normalized to 1.0 was used to generate the responses.  In other words, for a total flux of 0.5 and 2.0, (\ref{eq:response})~and~(\ref{eq:normalize}) used {\it inconsistent} fluxes, as would be the case were the total flux not known.  Shown in \FIG{fig:different_total_fluxes} are the group-wise, relative errors resulting from the study.  On the average, if the total flux is doubled or halved (relative to the flux used for generating responses), the resulting average, group-wise error is less than a factor of three.  In other words, the unfolding is not extremely sensitive to the total flux normalization.

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/different_total_fluxes.pdf}
  \caption{Impact of total flux normalization on group-wise, relative errors (\%) for case 4.  Average  errors shown in parentheses inside the legend.}
  \label{fig:different_total_fluxes}
\end{figure}

The original scope of this study intended to focus on the simplest of maximum entropy techniques.  However, a comparison to simple inversion techniques is warranted.  Shown in \FIG{fig:maxent_vs_minnorm} are the results for case 4 based on maximum entropy, minimum-norm, and Tikhonov-regularization.  For the latter, two values of $a$ were used: 0.1 and 0.01.  Overall, the maximum-entropy spectrum is closer (qualitatively and quantitatively) to the reference spectrum.  Both the minimum-norm and Tikhonov-regularization solutions contained negative values at energies near 1 eV.  Finally, the Tikhonov-regularization solution appears to be rather insensitive to the value of $a$ used in this particular application.  

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/maxent_vs_minnorm.pdf}
  \caption{Comparison of maximum-entropy, minimum-norm, and Tikhonov-regularization spectra for case 4.   Average  errors (\%) shown in parentheses inside the legend.}
  \label{fig:maxent_vs_minnorm}
\end{figure}

Inspired by other work presented at this conference \cite{kaiba2017cso}, a study was performed to determine the utility of thermal-neutron filters for providing additional responses given a fixed number of fissile nuclides.  In particular, case 3 was revisited with the addition of ${}^{113}$Cd and ${}^{155}$Gd.  As a simple approximation, the attenuation of thermal neutrons due to 0.025 mm foils of each isotope was built directly into the fission response functions, the results of which are shown in \FIG{fig:filtered_responses_cd} and \FIG{fig:filtered_responses_gd}.  The filters were only applied to the nuclides with appreciable thermal sensitivity, i.e., ${}^{233}$U, ${}^{235}$U, ${}^{238}$Pu, ${}^{239}$Pu, and ${}^{241}$Pu.

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/filtered_responses_cd.pdf}
  \caption{Cd-filtered and unfiltered responses for thermal-sensitive nuclides of case 3.}
  \label{fig:filtered_responses_cd}
\end{figure}

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/filtered_responses_gd.pdf}
  \caption{Gd-filtered and unfiltered responses for thermal-sensitive nuclides of case 3.}
  \label{fig:filtered_responses_gd}
\end{figure}

The results of the filter study are shown in \FIG{fig:filtered_unfold}, with the results near 1 eV magnified in \FIG{fig:filtered_unfold_zoom}.  The results indicate that filtering improves the results, with use of Cd leading to a reduction from 63\% to 39\% in the average, group-wise, relative error.  Use of Gd is less effective, reducing the error to 53\%.  A combination of both filters leads to nearly a reduction by two in the error.  Note, although only the same number of fissile nuclides were used in this scenario, the addition of one filter doubles the number of unique responses available, while two filters triples the number of responses. 


\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/filtered_unfold.pdf}
  \caption{Unfolded spectra for case 3 with and without filters.   Average  errors (\%) shown in parentheses inside the legend.}
  \label{fig:filtered_unfold}
\end{figure}

\begin{figure}[h!tb]
  \centering
  \includegraphics[width = 0.49\textwidth]{../img/filtered_unfold_zoom.pdf}
  \caption{Same as \FIG{fig:filtered_unfold} but zoomed in on energies near 1 eV.}
  \label{fig:filtered_unfold_zoom}
\end{figure}


\section{Conclusion}

The primary question addressed by this work has been whether or not a multichambered fission detector could be used for in-core spectroscopy.  The basic conclusion to be made is that such spectroscopy is possible, to an extent.  Overall, the maximum entropy approach, when coupled to 5 or more responses (whether from unique nuclides or use of filters), can provide spectra with average, group-wise, relative errors of less than 100\% assuming that the total flux is well known.  

Clearly, this work is scoping in nature, and the algorithms used throughout are simple and incorporate no prior information.  More complicated methods should be explored that admit uncertainties in the responses and use of prior spectral information, e.g., like those implemented in the MAXED unfolding code \cite{reginatto1999maxed, reginatto2002spectrum}.  In addition, more work should be performed to identify candidate filters to maximize the utility of small subsets of fissile (or fissionable) nuclides given that the availability of some nuclides included in this study may be limited.  



 
% use section* for acknowledgment
\section*{Acknowledgment}


The author would like to thank Prof.~Amir Bahadori for some helpful discussions.


% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi



% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://mirror.ctan.org/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)
% \begin{thebibliography}{1}

% \bibitem{IEEEhowto:kopka}
% H.~Kopka and P.~W. Daly, \emph{A Guide to \LaTeX}, 3rd~ed.\hskip 1em plus
%   0.5em minus 0.4em\relax Harlow, England: Addison-Wesley, 1999.

% \end{thebibliography}
\bibliography{refs}
% biography section
% 
% If you have an EPS/PDF photo (graphicx package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:





% insert where needed to balance the two columns on the last page with
% biographies
%\newpage

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}



% that's all folks
\end{document}


